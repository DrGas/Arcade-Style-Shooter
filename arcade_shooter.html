<!doctype html>
<html>
<head>
<meta charset="utf-8">
<title></title>
<script type="text/javascript" src="https://code.createjs.com/1.0.0/createjs.min.js"></script>
<script type="text/javascript">
	
	
var gun, target, w, h, score, bullet; // global variables

	function init(){
	stage = new createjs.Stage("demoCanvas");
	h = demoCanvas.height;
	w = demoCanvas.width;

	drawBullet();
	drawTarget();
	drawGun();
	moveTarget();
	addScore();

	window.onkeydown = onKey;
	
	createjs.Ticker.on("tick", tick); // the main listener
	
}
	
function tick(event) {

	stage.update(event);
	
}
	

	 
function drawGun(){
	gun = new createjs.Shape(); 
	gunColor = gun.graphics.beginFill('#00CED1').command; //COMMAND STORES THE LAST ACTION
	gun.graphics.drawRect(0, 0, 10, 60); 
	gun.x = w - 300;
	gun.y = h - 10;
	stage.addChild(gun);
	//console.log('created gun');
	//add tickcker function and gunControll createjs.Ticker.on("tick", gunControl);
}
	
function drawTarget(){
	target = new createjs.Shape();  
	targetColor = target.graphics.beginFill('#00FF00').command; //COMMAND STORES THE LAST ACTION
	target.graphics.drawRect(0, 0, 50, 10); 
	target.x = w - w + 10; //where the target begin to move
	target.y = h - h + 30;
	stage.addChild(target);
	targetCoord = target.x;
	//console.log('created target');
}
	
function moveTarget(){
	createjs.Tween.get(target, {loop:true})
	//first parameter is position, second the time for animation to move the circle in miliseconds
	.to({x: w - 40, y: h - h + 30 }, 4000)
		.wait(50)
		.to({x: target.x, y: h - h + 30}, 4000);
}
	
	
function drawBullet(){
	
}
	
	function bulletControl(event) {
		var pt = bullet.localtoLocal(bulletCoord,300,target); //300 is a stage hight - it needs to be this so the bullet will go straight 
		if (target.hitTest(pt.x, pt.y)) {
			stage.removeChild(bullet);
			target.alpha = 0.1;
			score++;
			score.text = score.value;
			event.remove();
		};
		
	if (pt.y<=10) {
	fired=false;
	target.alpha=1;
	stage.removeChild(bullet)
	event.remove();
		
	}
		stage.update(event)}
	
	
	
	
//function gunControll(event) {
//	var pt = gun.localtoLocal(gunCoordination,300, target) - comparing coordinates of bullet and target, x of a bullet and x of a target, hittest works only when it comepares x cooridnates 
// 	if target.hittest(pt.x, pt.y)) {
//  stage.removeChild(bullet)
//	target.apha =0.1
//	score++
//	score.text = score.value
//	
	
//	};
	
//if (pt.y<=10) {
//	fired=false;
//	target.alpha=1;
//	stage.removeChild(bullet)
//	event.remove();} 
//}	
	
function operateGun(event){
	
	bullet = new createjs.Shape();
	bulletColor = bullet.graphics.beginFill('#FF69B4');
	bullet.graphics.drawRect(0, 0, 10, 10);
	bullet.x = gun.x;
	bullet.y = gun.y;

	console.log('you have a bullet');
	
	createjs.Tween.get(bullet)
	.to({y: h - h - 40}, 800)
	stage.addChild(bullet)
	
}
	
function onKey(e){
	
	switch(e.keyCode) {
		case 37: 
			console.log('move left');
			gun.x -= 10;
			break;
				
		case 39: 
			console.log('move right');
			gun.x += 10;
			break;
				
		case 32: //space bar code
			operateGun();
			console.log ('bullet up')
			bulletSound();
			addScore();
			break;
					}
	
}	
	
	
function addScore() {
	
	//0 IS CONNECTED WITH SCORE.TEXT AND SCORE.TEXT IS CONNECTED WITH SCORE.VALUE WHICH IS INCREMENTED BY ONE WITH EACH CLICK
	score = new createjs.Text(0, "20px Helvetica", "#ff7700");
	//USING THE CALCULATION OF H AND W FROM STAGE 
	score.x = w - 30;
	score.y = h - h + 20;
	score.textBaseline = "alphabetic";
	score.value = 0;
	stage.addChild(score);
		
	}
	
	
	
		function bulletSound() {
		createjs.Sound.on("fileload", handleSound); // call the function handleSound()
		createjs.Sound.registerSound('audio/bullet.mp3', 'bullet');
		stage.removeChild(this); 
	}
	
	function handleSound() {
		sound = createjs.Sound.play('bullet')
		
	}
	
</script>
<style type="text/css">
#demoCanvas {
    border: 1px solid white;
    padding: 2px;
    background-color: #000000;
}
</style>
</head>

<body onload="init();">
<canvas id="demoCanvas" width="500" height="300"> alternate content </canvas>
</body>
</html>